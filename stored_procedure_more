select * from sales.orders;
select * 
from sales.order_items

begin 

declare @sales int;

select @sales = sum(quantity*list_price)

from sales.order_items s
inner join sales.orders o 
on s.order_id = o.order_id

where year(order_date) = 2018

select @sales
if @sales>1000000

begin 
print 'Great! The sales amount in 2018 is greater than 1,000,000'

end

end

Great! The sales amount in 2018 is greater than 1,000,000


--> Problem on 

BEGIN
    DECLARE @sales INT;

    SELECT 
        @sales = SUM(list_price * quantity)
    FROM
        sales.order_items i
        INNER JOIN sales.orders o ON o.order_id = i.order_id
    WHERE
        YEAR(order_date) = 2017;

    SELECT @sales;

    IF @sales > 10000000
    BEGIN
        PRINT 'Great! The sales amount in 2018 is greater than 10,000,000';
    END
    ELSE
    BEGIN
        PRINT 'Sales amount in 2017 did not reach 10,000,000';
    END
END



SELECT 
        @sales = SUM(list_price * quantity)
    FROM
        sales.order_items i
        INNER JOIN sales.orders o ON o.order_id = i.order_id
    WHERE
        YEAR(order_date) = 2017;
        
        
        
        
SELECT @sales;



IF @sales > 10000000
    BEGIN
        PRINT 'Great! The sales amount in 2018 is greater than 10,000,000';
    END
    ELSE
    BEGIN
        PRINT 'Sales amount in 2017 did not reach 10,000,000';
    END
    
    
